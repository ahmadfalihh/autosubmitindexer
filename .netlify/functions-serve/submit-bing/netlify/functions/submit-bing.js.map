{
  "version": 3,
  "sources": ["../../../../Documents/Bismillah2025SarengUmateKanjengNabiMuhammad/autosubmitindexerbysitemap/netlify/functions/submit-bing.js"],
  "sourceRoot": "C:/Users/user/AppData/Local/Temp/tmp-15672-5bBWesaUQEH6",
  "sourcesContent": ["// netlify/functions/submit-bing.js\r\nexports.handler = async function (event, context) {\r\n    if (event.httpMethod !== \"POST\") {\r\n        return { statusCode: 405, body: \"Method Not Allowed\" };\r\n    }\r\n\r\n    try {\r\n        const { urls } = JSON.parse(event.body);\r\n\r\n        const apiKey = process.env.BING_API_KEY;\r\n        if (!apiKey) {\r\n            return {\r\n                statusCode: 500,\r\n                body: JSON.stringify({\r\n                    platform: \"bing\",\r\n                    status: \"failed\",\r\n                    message: \"Environment variable BING_API_KEY is missing.\"\r\n                })\r\n            };\r\n        }\r\n\r\n        if (!urls || !Array.isArray(urls) || urls.length === 0) {\r\n            return { statusCode: 400, body: JSON.stringify({ error: \"No URLs provided\" }) };\r\n        }\r\n\r\n        let host;\r\n        try {\r\n            const u = new URL(urls[0]);\r\n            host = u.hostname;\r\n        } catch (e) {\r\n            return { statusCode: 400, body: JSON.stringify({ error: \"Invalid URL format\" }) };\r\n        }\r\n\r\n        const payload = {\r\n            host,\r\n            key: apiKey,\r\n            urlList: urls\r\n        };\r\n\r\n        const response = await fetch(\"https://api.indexnow.org/indexnow\", {\r\n            method: \"POST\",\r\n            headers: { \"Content-Type\": \"application/json; charset=utf-8\" },\r\n            body: JSON.stringify(payload)\r\n        });\r\n\r\n        const body = await response.text();\r\n        const isSuccess = response.status === 200 || response.status === 202;\r\n\r\n        return {\r\n            statusCode: 200,\r\n            body: JSON.stringify({\r\n                platform: \"bing\",\r\n                status: isSuccess ? \"success\" : \"failed\",\r\n                code: response.status,\r\n                message: isSuccess ? \"Submitted to IndexNow\" : `Bing Error: ${body}`\r\n            })\r\n        };\r\n\r\n    } catch (err) {\r\n        return { statusCode: 500, body: JSON.stringify({ platform: \"bing\", status: \"error\", message: err.message }) };\r\n    }\r\n};\r\n"],
  "mappings": ";AACA,QAAQ,UAAU,eAAgB,OAAO,SAAS;AAC9C,MAAI,MAAM,eAAe,QAAQ;AAC7B,WAAO,EAAE,YAAY,KAAK,MAAM,qBAAqB;AAAA,EACzD;AAEA,MAAI;AACA,UAAM,EAAE,KAAK,IAAI,KAAK,MAAM,MAAM,IAAI;AAEtC,UAAM,SAAS,QAAQ,IAAI;AAC3B,QAAI,CAAC,QAAQ;AACT,aAAO;AAAA,QACH,YAAY;AAAA,QACZ,MAAM,KAAK,UAAU;AAAA,UACjB,UAAU;AAAA,UACV,QAAQ;AAAA,UACR,SAAS;AAAA,QACb,CAAC;AAAA,MACL;AAAA,IACJ;AAEA,QAAI,CAAC,QAAQ,CAAC,MAAM,QAAQ,IAAI,KAAK,KAAK,WAAW,GAAG;AACpD,aAAO,EAAE,YAAY,KAAK,MAAM,KAAK,UAAU,EAAE,OAAO,mBAAmB,CAAC,EAAE;AAAA,IAClF;AAEA,QAAI;AACJ,QAAI;AACA,YAAM,IAAI,IAAI,IAAI,KAAK,CAAC,CAAC;AACzB,aAAO,EAAE;AAAA,IACb,SAAS,GAAG;AACR,aAAO,EAAE,YAAY,KAAK,MAAM,KAAK,UAAU,EAAE,OAAO,qBAAqB,CAAC,EAAE;AAAA,IACpF;AAEA,UAAM,UAAU;AAAA,MACZ;AAAA,MACA,KAAK;AAAA,MACL,SAAS;AAAA,IACb;AAEA,UAAM,WAAW,MAAM,MAAM,qCAAqC;AAAA,MAC9D,QAAQ;AAAA,MACR,SAAS,EAAE,gBAAgB,kCAAkC;AAAA,MAC7D,MAAM,KAAK,UAAU,OAAO;AAAA,IAChC,CAAC;AAED,UAAM,OAAO,MAAM,SAAS,KAAK;AACjC,UAAM,YAAY,SAAS,WAAW,OAAO,SAAS,WAAW;AAEjE,WAAO;AAAA,MACH,YAAY;AAAA,MACZ,MAAM,KAAK,UAAU;AAAA,QACjB,UAAU;AAAA,QACV,QAAQ,YAAY,YAAY;AAAA,QAChC,MAAM,SAAS;AAAA,QACf,SAAS,YAAY,0BAA0B,eAAe,IAAI;AAAA,MACtE,CAAC;AAAA,IACL;AAAA,EAEJ,SAAS,KAAK;AACV,WAAO,EAAE,YAAY,KAAK,MAAM,KAAK,UAAU,EAAE,UAAU,QAAQ,QAAQ,SAAS,SAAS,IAAI,QAAQ,CAAC,EAAE;AAAA,EAChH;AACJ;",
  "names": []
}
